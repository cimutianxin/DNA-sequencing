import pandas as pd
import matplotlib.pyplot as plt

seq_A='PAAAAAAACCTTCCXTTTTCCCGTCCGCTCGTTCGCGCCTGTCTGCTTGTTTGCGTGTGCCGGTCGGCTAAGCATTCTCATGCAGGTCGTAGCC'
seq_B='PAAAAAAACCTTCCXTGTTTGCGTGTGCCGGTCGGCTGGTTGGCGGGTGGGCCCATCAAAACACTCATAAGCATTCTCATGCAGGTCGTAGCC'

ref_seqs_map = {
    "AAAA": 45.8,
    "AAAC": 42.1,
    "AAAG": 47.5,
    "AAAT": 46.4,
    "AACA": 46.4,
    "AACC": 39.3,
    "AACG": 41.6,
    "AACT": 39.7,
    "AAGA": 47.5,
    "AAGC": 41.5,
    "AAGG": 45.2,
    "AAGT": 44.4,
    "AATA": 40.2,
    "AATC": 35.2,
    "AATG": 39.4,
    "AATT": 36.7,
    "ACAA": 46.4,
    "ACAC": 43.4,
    "ACAG": 44.7,
    "ACAT": 45.2,
    "ACCA": 42.7,
    "ACCC": 40.7,
    "ACCG": 46.3,
    "ACCT": 41.5,
    "ACGA": 46.6,
    "ACGC": 39.7,
    "ACGG": 44.5,
    "ACGT": 42.3,
    "ACTA": 41.9,
    "ACTC": 37.4,
    "ACTG": 40.1,
    "ACTT": 36.1,
    "AGAA": 56.3,
    "AGAC": 45.0,
    "AGAG": 54.1,
    "AGAT": 47.7,
    "AGCA": 49.1,
    "AGCC": 41.8,
    "AGCG": 51.7,
    "AGCT": 44.0,
    "AGGA": 47.9,
    "AGGC": 38.3,
    "AGGG": 41.8,
    "AGGT": 37.4,
    "AGTA": 31.5,
    "AGTC": 24.3,
    "AGTG": 34.6,
    "AGTT": 27.3,
    "ATAA": 44.6,
    "ATAC": 42.5,
    "ATAG": 42.0,
    "ATAT": 42.8,
    "ATCA": 37.2,
    "ATCC": 35.3,
    "ATCG": 39.8,
    "ATCT": 37.4,
    "ATGA": 36.4,
    "ATGC": 30.7,
    "ATGG": 36.0,
    "ATGT": 33.0,
    "ATTA": 31.6,
    "ATTC": 26.4,
    "ATTG": 31.4,
    "CAAA": 46.4,
    "CAAC": 43.5,
    "CAAG": 47.5,
    "CAAT": 43.2,
    "CACA": 47.1,
    "CACC": 40.6,
    "CACG": 39.7,
    "CACT": 41.1,
    "CAGA": 47.7,
    "CAGC": 37.0,
    "CAGG": 42.9,
    "CAGT": 37.4,
    "CATA": 42.8,
    "CATC": 35.3,
    "CATG": 38.9,
    "CATT": 31.4,
    "CCAA": 45.3,
    "CCAC": 42.7,
    "CCAG": 43.7,
    "CCAT": 43.3,
    "CCCA": 46.3,
    "CCCC": 42.6,
    "CCCG": 43.0,
    "CCCT": 37.8,
    "CCGA": 46.3,
    "CCGC": 40.7,
    "CCGG": 43.2,
    "CCGT": 38.0,
    "CCTA": 43.9,
    "CCTC": 37.8,
    "CCTG": 34.1,
    "CCTT": 32.8,
    "CGAA": 51.3,
    "CGAC": 42.4,
    "CGAG": 46.4,
    "CGAT": 44.4,
    "CGCA": 47.8,
    "CGCC": 40.2,
    "CGCG": 43.1,
    "CGCT": 40.7,
    "CGGA": 40.7,
    "CGGC": 33.5,
    "CGGG": 36.2,
    "CGGT": 31.6,
    "CGTA": 27.0,
    "CGTC": 16.8,
    "CGTG": 21.8,
    "CGTT": 17.7,
    "CTAA": 47.3,
    "CTAC": 40.4,
    "CTAG": 44.8,
    "CTAT": 37.0,
    "CTCA": 44.1,
    "CTCC": 37.5,
    "CTCG": 35.7,
    "CTCT": 38.6,
    "CTGA": 34.3,
    "CTGC": 27.5,
    "CTGG": 34.1,
    "CTGT": 24.5,
    "CTTA": 31.2,
    "CTTC": 22.1,
    "CTTG": 27.4,
    "CTTT": 24.0,
    "GAAA": 56.3,
    "GAAC": 44.6,
    "GAAG": 48.7,
    "GAAT": 48.6,
    "GACA": 45.8,
    "GACC": 38.7,
    "GACG": 42.2,
    "GACT": 39.7,
    "GAGA": 47.4,
    "GAGC": 43.3,
    "GAGG": 43.4,
    "GAGT": 45.4,
    "GATA": 41.0,
    "GATC": 33.9,
    "GATG": 39.4,
    "GATT": 35.6,
    "GCAA": 49.1,
    "GCAC": 38.7,
    "GCAG": 48.0,
    "GCAT": 38.9,
    "GCCA": 44.4,
    "GCCC": 41.5,
    "GCCG": 43.2,
    "GCCT": 41.3,
    "GCGA": 47.2,
    "GCGC": 38.6,
    "GCGG": 45.6,
    "GCGT": 37.2,
    "GCTA": 36.8,
    "GCTC": 33.7,
    "GCTG": 36.0,
    "GCTT": 31.6,
    "GGAA": 51.8,
    "GGAC": 41.8,
    "GGAG": 46.7,
    "GGAT": 44.1,
    "GGCA": 43.7,
    "GGCC": 40.0,
    "GGCG": 42.3,
    "GGCT": 37.9,
    "GGGA": 41.8,
    "GGGC": 31.3,
    "GGGG": 30.2,
    "GGGT": 30.7,
    "GGTA": 28.0,
    "GGTC": 17.8,
    "GGTG": 25.5,
    "GGIT": 20.3,
    "GTAA": 40.3,
    "GTAC": 38.5,
    "GTAG": 38.0,
    "GTAT": 37.4,
    "GTCA": 35.7,
    "GTCC": 27.4,
    "GTCG": 30.6,
    "GTCT": 28.5,
    "GTGA": 33.5,
    "GTGC": 24.4,
    "GTGG": 22.9,
    "GTGT": 26.9,
    "GTTA": 29.5,
    "GTTC": 21.2,
    "GTTG": 27.5,
    "GTTT": 22.2,
    "TAAA": 44.6,
    "TAAC": 42.5,
    "TAAG": 47.6,
    "TAAT": 50.5,
    "TACA": 44.4,
    "TACC": 42.5,
    "TACG": 42.3,
    "TACT": 43.2,
    "TAGA": 45.8,
    "TAGC": 41.3,
    "TAGG": 44.0,
    "TAGT": 41.8,
    "TATA": 40.7,
    "TATC": 36.1,
    "TATG": 37.9,
    "TATT": 35.0,
    "TCAA": 43.7,
    "TCAC": 39.7,
    "TCAG": 46.3,
    "TCAT": 48.1,
    "TCCA": 43.7,
    "TCCC": 38.6,
    "TCCG": 39.3,
    "TCCT": 41.2,
    "TCGA": 46.4,
    "TCGC": 40.4,
    "TCGG": 40.0,
    "TCGT": 37.9,
    "TCTA": 42.1,
    "TCTC": 34.6,
    "TCTG": 32.8,
    "TCTT": 32.4,
    "TGAA": 45.6,
    "TGAC": 38.5,
    "TGAG": 42.4,
    "TGAT": 43.3,
    "TGCA": 42.8,
    "TGCC": 35.4,
    "TGCG": 40.6,
    "TGCT": 37.3,
    "TGGA": 38.7,
    "TGGC": 32.1,
    "TGGG": 33.7,
    "TGGT": 27.1,
    "TGTA": 27.1,
    "TGTC": 17.6,
    "TGTG": 21.7,
    "TGTT": 18.8,
    "TTAA": 40.1,
    "TTAC": 35.6,
    "TTAG": 41.8,
    "TTAT": 40.6,
    "TTCA": 36.0,
    "TTCC": 28.7,
    "TTCG": 33.2,
    "TTCT": 32.4,
    "TTGA": 33.1,
    "TTGC": 27.3,
    "TTGG": 32.1,
    "TTGT": 28.8,
    "TTTA": 29.2,
    "TTTC": 22.2,
    "TTTG": 25.9,
    "TTTT": 22.2,
}

def get_df_seq(seq):
    quadromers = [seq[i:i+4] for i in range(len(seq) - 3)]
    quadromer_values = []
    for quadromer in quadromers:
        if quadromer in ref_seqs_map:
            quadromer_values.append(ref_seqs_map[quadromer])
        else:
            quadromer_values.append(0)  # 或者你可以选择一个默认值
    df_seq = pd.DataFrame({'Quadromers': quadromers, 'Values': quadromer_values})
    return df_seq

def plot_df_seq(df):
    fig = plt.figure(figsize=(15, 3))
    # 'Values' 是你想要绘制的列
    plt.step(range(len(df_ref_seq_A)), df_ref_seq_A['Values'], where='post')
    # 设置横轴的刻度标签为 'Quadromers' 列的值
    plt.xticks(range(len(df_ref_seq_A)), df_ref_seq_A['Quadromers'], rotation=60)
    plt.xlabel('Quadromers')
    plt.ylabel('Values')
    plt.title('Step plot for df_ref_seq_A')
    plt.tight_layout()  # 确保所有的标签都能在图上显示出来
    plt.savefig('df_ref_seq_A_plot.png')
    return fig

fig = plot_df_seq(df_ref_seq_A)

